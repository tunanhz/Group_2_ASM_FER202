{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\asus\\\\Desktop\\\\ASM_FER202\\\\Group_2_ASM_FER202\\\\src\\\\components\\\\ServiceAssignment.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport DoctorHeader from './DoctorHeader';\nimport { getMedicalServices, getPatients, getDoctors, createMedicineRecord, createServiceOrder, createServiceOrderItem, updateWaitlistStatusAndVisitType, createInvoice, createServiceInvoice } from '../services/api';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst ServiceAssignment = () => {\n  _s();\n  const {\n    patientId,\n    waitlistId\n  } = useParams();\n  const navigate = useNavigate();\n  const [patient, setPatient] = useState(null);\n  const [medicalServices, setMedicalServices] = useState([]);\n  const [doctors, setDoctors] = useState([]);\n  const [selectedServices, setSelectedServices] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [submitting, setSubmitting] = useState(false);\n  const [currentDoctorId] = useState('1'); // Mock - should come from auth\n\n  useEffect(() => {\n    fetchData();\n  }, [patientId]);\n  const fetchData = async () => {\n    try {\n      setLoading(true);\n      const [patientsRes, servicesRes, doctorsRes] = await Promise.all([getPatients(), getMedicalServices(), getDoctors()]);\n      if (patientsRes.success) {\n        const foundPatient = patientsRes.data.find(p => p.id === patientId);\n        setPatient(foundPatient);\n      }\n      if (servicesRes.success) {\n        setMedicalServices(servicesRes.data);\n      }\n      if (doctorsRes.success) {\n        setDoctors(doctorsRes.data);\n      }\n    } catch (error) {\n      console.error('Error fetching data:', error);\n      alert('‚ùå C√≥ l·ªói x·∫£y ra khi t·∫£i d·ªØ li·ªáu: ' + error.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n  const handleServiceToggle = (serviceId, doctorId = '') => {\n    setSelectedServices(prev => {\n      const existingIndex = prev.findIndex(item => item.serviceId === serviceId);\n      if (existingIndex >= 0) {\n        // Remove if already selected\n        return prev.filter(item => item.serviceId !== serviceId);\n      } else {\n        // Add new service\n        return [...prev, {\n          serviceId,\n          doctorId\n        }];\n      }\n    });\n  };\n  const handleDoctorChange = (serviceId, doctorId) => {\n    setSelectedServices(prev => prev.map(item => item.serviceId === serviceId ? {\n      ...item,\n      doctorId\n    } : item));\n  };\n  const handleSubmit = async () => {\n    if (selectedServices.length === 0) {\n      alert('Vui l√≤ng ch·ªçn √≠t nh·∫•t m·ªôt d·ªãch v·ª•!');\n      return;\n    }\n    const invalidServices = selectedServices.filter(item => !item.doctorId);\n    if (invalidServices.length > 0) {\n      alert('Vui l√≤ng ch·ªçn b√°c sƒ© cho t·∫•t c·∫£ d·ªãch v·ª•!');\n      return;\n    }\n    setSubmitting(true);\n    try {\n      // ALWAYS create NEW medicine record for service assignment\n      // Lu√¥n t·∫°o MedicineRecord m·ªõi cho vi·ªác ch·ªâ ƒë·ªãnh d·ªãch v·ª•\n      console.log('üîÑ T·∫°o MedicineRecord m·ªõi cho ch·ªâ ƒë·ªãnh d·ªãch v·ª•...');\n      const newRecordRes = await createMedicineRecord({\n        patient_id: patientId\n      });\n      if (!newRecordRes.success) {\n        throw new Error('Kh√¥ng th·ªÉ t·∫°o h·ªì s∆° b·ªánh √°n m·ªõi');\n      }\n      const medicineRecordId = newRecordRes.data.id;\n      console.log('‚úÖ ƒê√£ t·∫°o MedicineRecord m·ªõi:', medicineRecordId);\n\n      // Create service order\n      const serviceOrderData = {\n        doctor_id: currentDoctorId,\n        order_date: new Date().toISOString().split('T')[0],\n        medicineRecord_id: medicineRecordId\n      };\n      const serviceOrderRes = await createServiceOrder(serviceOrderData);\n      if (!serviceOrderRes.success) {\n        throw new Error('Kh√¥ng th·ªÉ t·∫°o ƒë∆°n ch·ªâ ƒë·ªãnh');\n      }\n      const serviceOrderId = serviceOrderRes.data.id;\n\n      // Create service order items\n      const createdServiceItems = [];\n      for (const service of selectedServices) {\n        const itemData = {\n          service_order_id: serviceOrderId,\n          service_id: service.serviceId,\n          doctor_id: service.doctorId\n        };\n        const itemRes = await createServiceOrderItem(itemData);\n        if (itemRes.success) {\n          createdServiceItems.push({\n            id: itemRes.data.id,\n            service_id: service.serviceId,\n            ...itemData\n          });\n        } else {\n          console.error('Failed to create service item:', service);\n        }\n      }\n\n      // üî• AUTO-CREATE INVOICE FOR SERVICES (INSERT NG·∫¶M)\n      if (createdServiceItems.length > 0) {\n        console.log('üîÑ T·∫°o h√≥a ƒë∆°n t·ª± ƒë·ªông cho d·ªãch v·ª•...');\n\n        // Calculate total amount for all services\n        let totalAmount = 0;\n        const serviceInvoiceItems = [];\n        for (const item of createdServiceItems) {\n          const service = medicalServices.find(s => s.id === item.service_id);\n          if (service) {\n            // Parse service price (handle different formats)\n            let servicePrice = 0;\n            if (service.price && !isNaN(service.price)) {\n              servicePrice = parseInt(service.price);\n            } else if (service.price && typeof service.price === 'string') {\n              // Extract number from price string (e.g., \"200000\" from mixed text)\n              const priceMatch = service.price.match(/\\d+/);\n              if (priceMatch) {\n                servicePrice = parseInt(priceMatch[0]);\n              }\n            }\n\n            // Default quantity is 1 for services\n            const quantity = 1;\n            const itemTotal = servicePrice * quantity;\n            totalAmount += itemTotal;\n            serviceInvoiceItems.push({\n              service_order_item_id: item.id,\n              service_name: service.name,\n              quantity: quantity,\n              unit_price: servicePrice,\n              total: itemTotal\n            });\n          }\n        }\n\n        // Create main Invoice\n        const invoiceData = {\n          patient_id: patientId,\n          medicineRecord_id: medicineRecordId,\n          issue_date: new Date().toISOString().split('T')[0],\n          total_amount: totalAmount.toString(),\n          status: 'Pending'\n        };\n        const invoiceRes = await createInvoice(invoiceData);\n        if (invoiceRes.success) {\n          const invoiceId = invoiceRes.data.id;\n          console.log('‚úÖ ƒê√£ t·∫°o h√≥a ƒë∆°n ch√≠nh:', invoiceId);\n\n          // Create ServiceInvoice entries for each service\n          for (const invoiceItem of serviceInvoiceItems) {\n            const serviceInvoiceData = {\n              invoice_id: invoiceId,\n              service_order_item_id: invoiceItem.service_order_item_id,\n              quantity: invoiceItem.quantity.toString(),\n              unit_price: invoiceItem.unit_price.toString()\n            };\n            const serviceInvoiceRes = await createServiceInvoice(serviceInvoiceData);\n            if (serviceInvoiceRes.success) {\n              console.log(`‚úÖ ƒê√£ t·∫°o ServiceInvoice cho d·ªãch v·ª• ${invoiceItem.service_name}`);\n            } else {\n              console.error(`‚ùå L·ªói t·∫°o ServiceInvoice cho d·ªãch v·ª• ${invoiceItem.service_name}`);\n            }\n          }\n          console.log(`üí∞ T·ªïng s·ªë ti·ªÅn h√≥a ƒë∆°n: ${new Intl.NumberFormat('vi-VN').format(totalAmount)} VNƒê`);\n        } else {\n          console.error('‚ùå L·ªói t·∫°o h√≥a ƒë∆°n ch√≠nh');\n        }\n      }\n\n      // After service assignment: status=Waiting, visitType=Result (waiting for service results)\n      if (waitlistId) {\n        await updateWaitlistStatusAndVisitType(waitlistId, 'Waiting', 'Result');\n      }\n      alert('‚úÖ Ch·ªâ ƒë·ªãnh d·ªãch v·ª• v√† t·∫°o h√≥a ƒë∆°n th√†nh c√¥ng!');\n      navigate('/doctor-dashboard');\n    } catch (error) {\n      console.error('Error creating service assignment:', error);\n      alert('‚ùå C√≥ l·ªói x·∫£y ra khi ch·ªâ ƒë·ªãnh d·ªãch v·ª•: ' + error.message);\n    } finally {\n      setSubmitting(false);\n    }\n  };\n  const getServicePrice = service => {\n    return service.price && !isNaN(service.price) ? new Intl.NumberFormat('vi-VN').format(service.price) + ' VNƒê' : 'Li√™n h·ªá';\n  };\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container-fluid py-5\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"spinner-border text-primary\",\n          role: \"status\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"visually-hidden\",\n            children: \"\\u0110ang t\\u1EA3i...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 252,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"mt-3\",\n          children: \"\\u0110ang t\\u1EA3i d\\u1EEF li\\u1EC7u...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 249,\n      columnNumber: 13\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(DoctorHeader, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 262,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container-fluid py-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row mb-4\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-12\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"d-flex justify-content-between align-items-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                className: \"mb-1\",\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"fas fa-clipboard-list me-2 text-primary\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 270,\n                  columnNumber: 33\n                }, this), \"Ch\\u1EC9 \\u0110\\u1ECBnh D\\u1ECBch V\\u1EE5 Y T\\u1EBF\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 269,\n                columnNumber: 29\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-muted mb-0\",\n                children: \"Ch\\u1ECDn v\\xE0 ph\\xE2n c\\xF4ng d\\u1ECBch v\\u1EE5 cho b\\u1EC7nh nh\\xE2n\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 273,\n                columnNumber: 29\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 268,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn btn-outline-secondary\",\n              onClick: () => navigate('/doctor-dashboard'),\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"fas fa-arrow-left me-2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 279,\n                columnNumber: 29\n              }, this), \"Quay l\\u1EA1i\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 275,\n              columnNumber: 25\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 267,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 266,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 265,\n        columnNumber: 17\n      }, this), patient && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row mb-4\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-12\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"card border-0 shadow-sm\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"card-header bg-info text-white\",\n              children: /*#__PURE__*/_jsxDEV(\"h5\", {\n                className: \"mb-0\",\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"fas fa-user me-2\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 293,\n                  columnNumber: 37\n                }, this), \"Th\\xF4ng Tin B\\u1EC7nh Nh\\xE2n\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 292,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 291,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"card-body\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"row\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"col-md-6\",\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"H\\u1ECD t\\xEAn:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 300,\n                    columnNumber: 41\n                  }, this), \" \", patient.full_name]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 299,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"col-md-6\",\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Gi\\u1EDBi t\\xEDnh:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 303,\n                    columnNumber: 41\n                  }, this), \" \", patient.gender]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 302,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"col-md-6\",\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"Ng\\xE0y sinh:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 306,\n                    columnNumber: 41\n                  }, this), \" \", patient.dob]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 305,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"col-md-6\",\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: \"\\u0110i\\u1EC7n tho\\u1EA1i:\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 309,\n                    columnNumber: 41\n                  }, this), \" \", patient.phone]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 308,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 298,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 297,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 290,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 289,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 288,\n        columnNumber: 17\n      }, this), selectedServices.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row mb-4\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-12\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"card border-0 shadow-sm\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"card-header bg-success text-white\",\n              children: /*#__PURE__*/_jsxDEV(\"h5\", {\n                className: \"mb-0\",\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"fas fa-check-circle me-2\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 325,\n                  columnNumber: 37\n                }, this), \"D\\u1ECBch V\\u1EE5 \\u0110\\xE3 Ch\\u1ECDn (\", selectedServices.length, \")\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 324,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 323,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"card-body\",\n              children: selectedServices.map((item, index) => {\n                const service = medicalServices.find(s => s.id === item.serviceId);\n                const doctor = doctors.find(d => d.id === item.doctorId);\n                return /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"d-flex justify-content-between align-items-center mb-2\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                      children: service === null || service === void 0 ? void 0 : service.name\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 336,\n                      columnNumber: 49\n                    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 337,\n                      columnNumber: 49\n                    }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n                      className: \"text-muted\",\n                      children: [\"B\\xE1c s\\u0129: \", (doctor === null || doctor === void 0 ? void 0 : doctor.full_name) || 'Ch∆∞a ch·ªçn']\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 338,\n                      columnNumber: 49\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 335,\n                    columnNumber: 45\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"badge bg-primary\",\n                    children: getServicePrice(service)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 342,\n                    columnNumber: 45\n                  }, this)]\n                }, index, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 334,\n                  columnNumber: 41\n                }, this);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 329,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 322,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 321,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 320,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row mb-4\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-12\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"card border-0 shadow-sm\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"card-header bg-primary text-white\",\n              children: /*#__PURE__*/_jsxDEV(\"h5\", {\n                className: \"mb-0\",\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"fas fa-stethoscope me-2\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 360,\n                  columnNumber: 33\n                }, this), \"Danh S\\xE1ch D\\u1ECBch V\\u1EE5 Y T\\u1EBF\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 359,\n                columnNumber: 29\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 358,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"card-body p-0\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"table-responsive\",\n                children: /*#__PURE__*/_jsxDEV(\"table\", {\n                  className: \"table table-hover mb-0\",\n                  children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n                    className: \"table-light\",\n                    children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                        width: \"50\",\n                        children: \"Ch\\u1ECDn\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 369,\n                        columnNumber: 45\n                      }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                        children: \"T\\xEAn D\\u1ECBch V\\u1EE5\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 370,\n                        columnNumber: 45\n                      }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                        children: \"M\\xF4 T\\u1EA3\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 371,\n                        columnNumber: 45\n                      }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                        children: \"Gi\\xE1\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 372,\n                        columnNumber: 45\n                      }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                        children: \"B\\xE1c S\\u0129 Th\\u1EF1c Hi\\u1EC7n\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 373,\n                        columnNumber: 45\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 368,\n                      columnNumber: 41\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 367,\n                    columnNumber: 37\n                  }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n                    children: medicalServices.map(service => {\n                      const isSelected = selectedServices.some(item => item.serviceId === service.id);\n                      const selectedService = selectedServices.find(item => item.serviceId === service.id);\n                      return /*#__PURE__*/_jsxDEV(\"tr\", {\n                        className: isSelected ? 'table-primary' : '',\n                        children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                          children: /*#__PURE__*/_jsxDEV(\"input\", {\n                            type: \"checkbox\",\n                            className: \"form-check-input\",\n                            checked: isSelected,\n                            onChange: () => handleServiceToggle(service.id)\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 384,\n                            columnNumber: 57\n                          }, this)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 383,\n                          columnNumber: 53\n                        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                          children: /*#__PURE__*/_jsxDEV(\"strong\", {\n                            children: service.name\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 392,\n                            columnNumber: 57\n                          }, this)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 391,\n                          columnNumber: 53\n                        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                          children: /*#__PURE__*/_jsxDEV(\"span\", {\n                            className: \"text-muted\",\n                            children: service.description\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 395,\n                            columnNumber: 57\n                          }, this)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 394,\n                          columnNumber: 53\n                        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                          children: /*#__PURE__*/_jsxDEV(\"span\", {\n                            className: \"badge bg-info\",\n                            children: getServicePrice(service)\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 398,\n                            columnNumber: 57\n                          }, this)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 397,\n                          columnNumber: 53\n                        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                          children: isSelected ? /*#__PURE__*/_jsxDEV(\"select\", {\n                            className: \"form-select form-select-sm\",\n                            value: (selectedService === null || selectedService === void 0 ? void 0 : selectedService.doctorId) || '',\n                            onChange: e => handleDoctorChange(service.id, e.target.value),\n                            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                              value: \"\",\n                              children: \"-- Ch\\u1ECDn b\\xE1c s\\u0129 --\"\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 409,\n                              columnNumber: 65\n                            }, this), doctors.map(doctor => /*#__PURE__*/_jsxDEV(\"option\", {\n                              value: doctor.id,\n                              children: [doctor.full_name, \" - \", doctor.specialization]\n                            }, doctor.id, true, {\n                              fileName: _jsxFileName,\n                              lineNumber: 411,\n                              columnNumber: 69\n                            }, this))]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 404,\n                            columnNumber: 61\n                          }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n                            className: \"text-muted\",\n                            children: \"--\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 417,\n                            columnNumber: 61\n                          }, this)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 402,\n                          columnNumber: 53\n                        }, this)]\n                      }, service.id, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 382,\n                        columnNumber: 49\n                      }, this);\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 376,\n                    columnNumber: 37\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 366,\n                  columnNumber: 33\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 365,\n                columnNumber: 29\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 364,\n              columnNumber: 25\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 357,\n            columnNumber: 21\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 356,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 355,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-12\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"d-flex justify-content-end gap-3\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn btn-outline-secondary\",\n              onClick: () => navigate('/doctor-dashboard'),\n              disabled: submitting,\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"fas fa-times me-2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 440,\n                columnNumber: 29\n              }, this), \"H\\u1EE7y b\\u1ECF\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 435,\n              columnNumber: 25\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn btn-primary\",\n              onClick: handleSubmit,\n              disabled: submitting || selectedServices.length === 0,\n              children: submitting ? /*#__PURE__*/_jsxDEV(\"span\", {\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"spinner-border spinner-border-sm me-2\",\n                  role: \"status\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 450,\n                  columnNumber: 37\n                }, this), \"\\u0110ang x\\u1EED l\\xFD...\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 449,\n                columnNumber: 33\n              }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"fas fa-save me-2\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 455,\n                  columnNumber: 37\n                }, this), \"Ch\\u1EC9 \\u0110\\u1ECBnh D\\u1ECBch V\\u1EE5 (\", selectedServices.length, \")\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 454,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 443,\n              columnNumber: 25\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 434,\n            columnNumber: 21\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 433,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 432,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 263,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true);\n};\n_s(ServiceAssignment, \"79WgpzceTLz1JgkKyRsN6l4ccpo=\", false, function () {\n  return [useParams, useNavigate];\n});\n_c = ServiceAssignment;\nexport default ServiceAssignment;\nvar _c;\n$RefreshReg$(_c, \"ServiceAssignment\");","map":{"version":3,"names":["React","useState","useEffect","useParams","useNavigate","DoctorHeader","getMedicalServices","getPatients","getDoctors","createMedicineRecord","createServiceOrder","createServiceOrderItem","updateWaitlistStatusAndVisitType","createInvoice","createServiceInvoice","jsxDEV","_jsxDEV","Fragment","_Fragment","ServiceAssignment","_s","patientId","waitlistId","navigate","patient","setPatient","medicalServices","setMedicalServices","doctors","setDoctors","selectedServices","setSelectedServices","loading","setLoading","submitting","setSubmitting","currentDoctorId","fetchData","patientsRes","servicesRes","doctorsRes","Promise","all","success","foundPatient","data","find","p","id","error","console","alert","message","handleServiceToggle","serviceId","doctorId","prev","existingIndex","findIndex","item","filter","handleDoctorChange","map","handleSubmit","length","invalidServices","log","newRecordRes","patient_id","Error","medicineRecordId","serviceOrderData","doctor_id","order_date","Date","toISOString","split","medicineRecord_id","serviceOrderRes","serviceOrderId","createdServiceItems","service","itemData","service_order_id","service_id","itemRes","push","totalAmount","serviceInvoiceItems","s","servicePrice","price","isNaN","parseInt","priceMatch","match","quantity","itemTotal","service_order_item_id","service_name","name","unit_price","total","invoiceData","issue_date","total_amount","toString","status","invoiceRes","invoiceId","invoiceItem","serviceInvoiceData","invoice_id","serviceInvoiceRes","Intl","NumberFormat","format","getServicePrice","className","children","role","fileName","_jsxFileName","lineNumber","columnNumber","onClick","full_name","gender","dob","phone","index","doctor","d","width","isSelected","some","selectedService","type","checked","onChange","description","value","e","target","specialization","disabled","_c","$RefreshReg$"],"sources":["C:/Users/asus/Desktop/ASM_FER202/Group_2_ASM_FER202/src/components/ServiceAssignment.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport DoctorHeader from './DoctorHeader';\r\nimport { \r\n    getMedicalServices,\r\n    getPatients,\r\n    getDoctors,\r\n    createMedicineRecord,\r\n    createServiceOrder,\r\n    createServiceOrderItem,\r\n    updateWaitlistStatusAndVisitType,\r\n    createInvoice,\r\n    createServiceInvoice\r\n} from '../services/api';\r\n\r\nconst ServiceAssignment = () => {\r\n    const { patientId, waitlistId } = useParams();\r\n    const navigate = useNavigate();\r\n    \r\n    const [patient, setPatient] = useState(null);\r\n    const [medicalServices, setMedicalServices] = useState([]);\r\n    const [doctors, setDoctors] = useState([]);\r\n    const [selectedServices, setSelectedServices] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [submitting, setSubmitting] = useState(false);\r\n    const [currentDoctorId] = useState('1'); // Mock - should come from auth\r\n\r\n    useEffect(() => {\r\n        fetchData();\r\n    }, [patientId]);\r\n\r\n    const fetchData = async () => {\r\n        try {\r\n            setLoading(true);\r\n            const [patientsRes, servicesRes, doctorsRes] = await Promise.all([\r\n                getPatients(),\r\n                getMedicalServices(),\r\n                getDoctors()\r\n            ]);\r\n\r\n            if (patientsRes.success) {\r\n                const foundPatient = patientsRes.data.find(p => p.id === patientId);\r\n                setPatient(foundPatient);\r\n            }\r\n\r\n            if (servicesRes.success) {\r\n                setMedicalServices(servicesRes.data);\r\n            }\r\n\r\n            if (doctorsRes.success) {\r\n                setDoctors(doctorsRes.data);\r\n            }\r\n\r\n        } catch (error) {\r\n            console.error('Error fetching data:', error);\r\n            alert('‚ùå C√≥ l·ªói x·∫£y ra khi t·∫£i d·ªØ li·ªáu: ' + error.message);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleServiceToggle = (serviceId, doctorId = '') => {\r\n        setSelectedServices(prev => {\r\n            const existingIndex = prev.findIndex(item => item.serviceId === serviceId);\r\n            \r\n            if (existingIndex >= 0) {\r\n                // Remove if already selected\r\n                return prev.filter(item => item.serviceId !== serviceId);\r\n            } else {\r\n                // Add new service\r\n                return [...prev, { serviceId, doctorId }];\r\n            }\r\n        });\r\n    };\r\n\r\n    const handleDoctorChange = (serviceId, doctorId) => {\r\n        setSelectedServices(prev => \r\n            prev.map(item => \r\n                item.serviceId === serviceId \r\n                    ? { ...item, doctorId }\r\n                    : item\r\n            )\r\n        );\r\n    };\r\n\r\n    const handleSubmit = async () => {\r\n        if (selectedServices.length === 0) {\r\n            alert('Vui l√≤ng ch·ªçn √≠t nh·∫•t m·ªôt d·ªãch v·ª•!');\r\n            return;\r\n        }\r\n\r\n        const invalidServices = selectedServices.filter(item => !item.doctorId);\r\n        if (invalidServices.length > 0) {\r\n            alert('Vui l√≤ng ch·ªçn b√°c sƒ© cho t·∫•t c·∫£ d·ªãch v·ª•!');\r\n            return;\r\n        }\r\n\r\n        setSubmitting(true);\r\n\r\n        try {\r\n            // ALWAYS create NEW medicine record for service assignment\r\n            // Lu√¥n t·∫°o MedicineRecord m·ªõi cho vi·ªác ch·ªâ ƒë·ªãnh d·ªãch v·ª•\r\n            console.log('üîÑ T·∫°o MedicineRecord m·ªõi cho ch·ªâ ƒë·ªãnh d·ªãch v·ª•...');\r\n            const newRecordRes = await createMedicineRecord({\r\n                patient_id: patientId\r\n            });\r\n            \r\n            if (!newRecordRes.success) {\r\n                throw new Error('Kh√¥ng th·ªÉ t·∫°o h·ªì s∆° b·ªánh √°n m·ªõi');\r\n            }\r\n\r\n            const medicineRecordId = newRecordRes.data.id;\r\n            console.log('‚úÖ ƒê√£ t·∫°o MedicineRecord m·ªõi:', medicineRecordId);\r\n\r\n            // Create service order\r\n            const serviceOrderData = {\r\n                doctor_id: currentDoctorId,\r\n                order_date: new Date().toISOString().split('T')[0],\r\n                medicineRecord_id: medicineRecordId\r\n            };\r\n\r\n            const serviceOrderRes = await createServiceOrder(serviceOrderData);\r\n            if (!serviceOrderRes.success) {\r\n                throw new Error('Kh√¥ng th·ªÉ t·∫°o ƒë∆°n ch·ªâ ƒë·ªãnh');\r\n            }\r\n\r\n            const serviceOrderId = serviceOrderRes.data.id;\r\n\r\n            // Create service order items\r\n            const createdServiceItems = [];\r\n            for (const service of selectedServices) {\r\n                const itemData = {\r\n                    service_order_id: serviceOrderId,\r\n                    service_id: service.serviceId,\r\n                    doctor_id: service.doctorId\r\n                };\r\n\r\n                const itemRes = await createServiceOrderItem(itemData);\r\n                if (itemRes.success) {\r\n                    createdServiceItems.push({\r\n                        id: itemRes.data.id,\r\n                        service_id: service.serviceId,\r\n                        ...itemData\r\n                    });\r\n                } else {\r\n                    console.error('Failed to create service item:', service);\r\n                }\r\n            }\r\n\r\n            // üî• AUTO-CREATE INVOICE FOR SERVICES (INSERT NG·∫¶M)\r\n            if (createdServiceItems.length > 0) {\r\n                console.log('üîÑ T·∫°o h√≥a ƒë∆°n t·ª± ƒë·ªông cho d·ªãch v·ª•...');\r\n                \r\n                // Calculate total amount for all services\r\n                let totalAmount = 0;\r\n                const serviceInvoiceItems = [];\r\n                \r\n                for (const item of createdServiceItems) {\r\n                    const service = medicalServices.find(s => s.id === item.service_id);\r\n                    if (service) {\r\n                        // Parse service price (handle different formats)\r\n                        let servicePrice = 0;\r\n                        if (service.price && !isNaN(service.price)) {\r\n                            servicePrice = parseInt(service.price);\r\n                        } else if (service.price && typeof service.price === 'string') {\r\n                            // Extract number from price string (e.g., \"200000\" from mixed text)\r\n                            const priceMatch = service.price.match(/\\d+/);\r\n                            if (priceMatch) {\r\n                                servicePrice = parseInt(priceMatch[0]);\r\n                            }\r\n                        }\r\n                        \r\n                        // Default quantity is 1 for services\r\n                        const quantity = 1;\r\n                        const itemTotal = servicePrice * quantity;\r\n                        totalAmount += itemTotal;\r\n                        \r\n                        serviceInvoiceItems.push({\r\n                            service_order_item_id: item.id,\r\n                            service_name: service.name,\r\n                            quantity: quantity,\r\n                            unit_price: servicePrice,\r\n                            total: itemTotal\r\n                        });\r\n                    }\r\n                }\r\n                \r\n                // Create main Invoice\r\n                const invoiceData = {\r\n                    patient_id: patientId,\r\n                    medicineRecord_id: medicineRecordId,\r\n                    issue_date: new Date().toISOString().split('T')[0],\r\n                    total_amount: totalAmount.toString(),\r\n                    status: 'Pending'\r\n                };\r\n                \r\n                const invoiceRes = await createInvoice(invoiceData);\r\n                if (invoiceRes.success) {\r\n                    const invoiceId = invoiceRes.data.id;\r\n                    console.log('‚úÖ ƒê√£ t·∫°o h√≥a ƒë∆°n ch√≠nh:', invoiceId);\r\n                    \r\n                    // Create ServiceInvoice entries for each service\r\n                    for (const invoiceItem of serviceInvoiceItems) {\r\n                        const serviceInvoiceData = {\r\n                            invoice_id: invoiceId,\r\n                            service_order_item_id: invoiceItem.service_order_item_id,\r\n                            quantity: invoiceItem.quantity.toString(),\r\n                            unit_price: invoiceItem.unit_price.toString()\r\n                        };\r\n                        \r\n                        const serviceInvoiceRes = await createServiceInvoice(serviceInvoiceData);\r\n                        if (serviceInvoiceRes.success) {\r\n                            console.log(`‚úÖ ƒê√£ t·∫°o ServiceInvoice cho d·ªãch v·ª• ${invoiceItem.service_name}`);\r\n                        } else {\r\n                            console.error(`‚ùå L·ªói t·∫°o ServiceInvoice cho d·ªãch v·ª• ${invoiceItem.service_name}`);\r\n                        }\r\n                    }\r\n                    \r\n                    console.log(`üí∞ T·ªïng s·ªë ti·ªÅn h√≥a ƒë∆°n: ${new Intl.NumberFormat('vi-VN').format(totalAmount)} VNƒê`);\r\n                } else {\r\n                    console.error('‚ùå L·ªói t·∫°o h√≥a ƒë∆°n ch√≠nh');\r\n                }\r\n            }\r\n\r\n            // After service assignment: status=Waiting, visitType=Result (waiting for service results)\r\n            if (waitlistId) {\r\n                await updateWaitlistStatusAndVisitType(waitlistId, 'Waiting', 'Result');\r\n            }\r\n\r\n            alert('‚úÖ Ch·ªâ ƒë·ªãnh d·ªãch v·ª• v√† t·∫°o h√≥a ƒë∆°n th√†nh c√¥ng!');\r\n            navigate('/doctor-dashboard');\r\n\r\n        } catch (error) {\r\n            console.error('Error creating service assignment:', error);\r\n            alert('‚ùå C√≥ l·ªói x·∫£y ra khi ch·ªâ ƒë·ªãnh d·ªãch v·ª•: ' + error.message);\r\n        } finally {\r\n            setSubmitting(false);\r\n        }\r\n    };\r\n\r\n    const getServicePrice = (service) => {\r\n        return service.price && !isNaN(service.price) \r\n            ? new Intl.NumberFormat('vi-VN').format(service.price) + ' VNƒê'\r\n            : 'Li√™n h·ªá';\r\n    };\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"container-fluid py-5\">\r\n                <div className=\"text-center\">\r\n                    <div className=\"spinner-border text-primary\" role=\"status\">\r\n                        <span className=\"visually-hidden\">ƒêang t·∫£i...</span>\r\n                    </div>\r\n                    <p className=\"mt-3\">ƒêang t·∫£i d·ªØ li·ªáu...</p>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <DoctorHeader />\r\n            <div className=\"container-fluid py-4\">\r\n                {/* Page Header */}\r\n                <div className=\"row mb-4\">\r\n                    <div className=\"col-12\">\r\n                        <div className=\"d-flex justify-content-between align-items-center\">\r\n                        <div>\r\n                            <h2 className=\"mb-1\">\r\n                                <i className=\"fas fa-clipboard-list me-2 text-primary\"></i>\r\n                                Ch·ªâ ƒê·ªãnh D·ªãch V·ª• Y T·∫ø\r\n                            </h2>\r\n                            <p className=\"text-muted mb-0\">Ch·ªçn v√† ph√¢n c√¥ng d·ªãch v·ª• cho b·ªánh nh√¢n</p>\r\n                        </div>\r\n                        <button \r\n                            className=\"btn btn-outline-secondary\"\r\n                            onClick={() => navigate('/doctor-dashboard')}\r\n                        >\r\n                            <i className=\"fas fa-arrow-left me-2\"></i>\r\n                            Quay l·∫°i\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Patient Info */}\r\n            {patient && (\r\n                <div className=\"row mb-4\">\r\n                    <div className=\"col-12\">\r\n                        <div className=\"card border-0 shadow-sm\">\r\n                            <div className=\"card-header bg-info text-white\">\r\n                                <h5 className=\"mb-0\">\r\n                                    <i className=\"fas fa-user me-2\"></i>\r\n                                    Th√¥ng Tin B·ªánh Nh√¢n\r\n                                </h5>\r\n                            </div>\r\n                            <div className=\"card-body\">\r\n                                <div className=\"row\">\r\n                                    <div className=\"col-md-6\">\r\n                                        <strong>H·ªç t√™n:</strong> {patient.full_name}\r\n                                    </div>\r\n                                    <div className=\"col-md-6\">\r\n                                        <strong>Gi·ªõi t√≠nh:</strong> {patient.gender}\r\n                                    </div>\r\n                                    <div className=\"col-md-6\">\r\n                                        <strong>Ng√†y sinh:</strong> {patient.dob}\r\n                                    </div>\r\n                                    <div className=\"col-md-6\">\r\n                                        <strong>ƒêi·ªán tho·∫°i:</strong> {patient.phone}\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Selected Services Summary */}\r\n            {selectedServices.length > 0 && (\r\n                <div className=\"row mb-4\">\r\n                    <div className=\"col-12\">\r\n                        <div className=\"card border-0 shadow-sm\">\r\n                            <div className=\"card-header bg-success text-white\">\r\n                                <h5 className=\"mb-0\">\r\n                                    <i className=\"fas fa-check-circle me-2\"></i>\r\n                                    D·ªãch V·ª• ƒê√£ Ch·ªçn ({selectedServices.length})\r\n                                </h5>\r\n                            </div>\r\n                            <div className=\"card-body\">\r\n                                {selectedServices.map((item, index) => {\r\n                                    const service = medicalServices.find(s => s.id === item.serviceId);\r\n                                    const doctor = doctors.find(d => d.id === item.doctorId);\r\n                                    return (\r\n                                        <div key={index} className=\"d-flex justify-content-between align-items-center mb-2\">\r\n                                            <div>\r\n                                                <strong>{service?.name}</strong>\r\n                                                <br />\r\n                                                <small className=\"text-muted\">\r\n                                                    B√°c sƒ©: {doctor?.full_name || 'Ch∆∞a ch·ªçn'}\r\n                                                </small>\r\n                                            </div>\r\n                                            <span className=\"badge bg-primary\">\r\n                                                {getServicePrice(service)}\r\n                                            </span>\r\n                                        </div>\r\n                                    );\r\n                                })}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Medical Services List */}\r\n            <div className=\"row mb-4\">\r\n                <div className=\"col-12\">\r\n                    <div className=\"card border-0 shadow-sm\">\r\n                        <div className=\"card-header bg-primary text-white\">\r\n                            <h5 className=\"mb-0\">\r\n                                <i className=\"fas fa-stethoscope me-2\"></i>\r\n                                Danh S√°ch D·ªãch V·ª• Y T·∫ø\r\n                            </h5>\r\n                        </div>\r\n                        <div className=\"card-body p-0\">\r\n                            <div className=\"table-responsive\">\r\n                                <table className=\"table table-hover mb-0\">\r\n                                    <thead className=\"table-light\">\r\n                                        <tr>\r\n                                            <th width=\"50\">Ch·ªçn</th>\r\n                                            <th>T√™n D·ªãch V·ª•</th>\r\n                                            <th>M√¥ T·∫£</th>\r\n                                            <th>Gi√°</th>\r\n                                            <th>B√°c Sƒ© Th·ª±c Hi·ªán</th>\r\n                                        </tr>\r\n                                    </thead>\r\n                                    <tbody>\r\n                                        {medicalServices.map((service) => {\r\n                                            const isSelected = selectedServices.some(item => item.serviceId === service.id);\r\n                                            const selectedService = selectedServices.find(item => item.serviceId === service.id);\r\n                                            \r\n                                            return (\r\n                                                <tr key={service.id} className={isSelected ? 'table-primary' : ''}>\r\n                                                    <td>\r\n                                                        <input\r\n                                                            type=\"checkbox\"\r\n                                                            className=\"form-check-input\"\r\n                                                            checked={isSelected}\r\n                                                            onChange={() => handleServiceToggle(service.id)}\r\n                                                        />\r\n                                                    </td>\r\n                                                    <td>\r\n                                                        <strong>{service.name}</strong>\r\n                                                    </td>\r\n                                                    <td>\r\n                                                        <span className=\"text-muted\">{service.description}</span>\r\n                                                    </td>\r\n                                                    <td>\r\n                                                        <span className=\"badge bg-info\">\r\n                                                            {getServicePrice(service)}\r\n                                                        </span>\r\n                                                    </td>\r\n                                                    <td>\r\n                                                        {isSelected ? (\r\n                                                            <select\r\n                                                                className=\"form-select form-select-sm\"\r\n                                                                value={selectedService?.doctorId || ''}\r\n                                                                onChange={(e) => handleDoctorChange(service.id, e.target.value)}\r\n                                                            >\r\n                                                                <option value=\"\">-- Ch·ªçn b√°c sƒ© --</option>\r\n                                                                {doctors.map(doctor => (\r\n                                                                    <option key={doctor.id} value={doctor.id}>\r\n                                                                        {doctor.full_name} - {doctor.specialization}\r\n                                                                    </option>\r\n                                                                ))}\r\n                                                            </select>\r\n                                                        ) : (\r\n                                                            <span className=\"text-muted\">--</span>\r\n                                                        )}\r\n                                                    </td>\r\n                                                </tr>\r\n                                            );\r\n                                        })}\r\n                                    </tbody>\r\n                                </table>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Action Buttons */}\r\n            <div className=\"row\">\r\n                <div className=\"col-12\">\r\n                    <div className=\"d-flex justify-content-end gap-3\">\r\n                        <button \r\n                            className=\"btn btn-outline-secondary\"\r\n                            onClick={() => navigate('/doctor-dashboard')}\r\n                            disabled={submitting}\r\n                        >\r\n                            <i className=\"fas fa-times me-2\"></i>\r\n                            H·ªßy b·ªè\r\n                        </button>\r\n                        <button \r\n                            className=\"btn btn-primary\"\r\n                            onClick={handleSubmit}\r\n                            disabled={submitting || selectedServices.length === 0}\r\n                        >\r\n                            {submitting ? (\r\n                                <span>\r\n                                    <span className=\"spinner-border spinner-border-sm me-2\" role=\"status\"></span>\r\n                                    ƒêang x·ª≠ l√Ω...\r\n                                </span>\r\n                            ) : (\r\n                                <span>\r\n                                    <i className=\"fas fa-save me-2\"></i>\r\n                                    Ch·ªâ ƒê·ªãnh D·ªãch V·ª• ({selectedServices.length})\r\n                                </span>\r\n                            )}\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default ServiceAssignment; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}